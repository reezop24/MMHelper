<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Risk Calculator XAUUSD</title>
  <link rel="stylesheet" href="global.css" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    .result-card {
      margin-top: 14px;
      border: 1px solid rgba(95, 145, 215, 0.45);
      border-radius: 12px;
      background: rgba(8, 26, 55, 0.78);
      padding: 12px;
    }

    .result-title {
      margin: 0 0 8px;
      color: #f4f9ff;
      font-size: 14px;
    }

    .result-line {
      margin: 0;
      color: #d8e6ff;
      font-size: 14px;
      line-height: 1.35;
    }

    .result-line + .result-line {
      margin-top: 7px;
    }

    #layerCount,
    #stopOutPct {
      width: 100%;
      border: 1px solid var(--border-input);
      background: #06142f;
      color: var(--text);
      border-radius: 10px;
      padding: 12px;
      font-size: 15px;
      line-height: 1.35;
      min-height: 46px;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
    }

    .risk-value {
      color: #ff8f8f;
    }

    .lot-value {
      color: #7ee0ff;
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 0.2px;
    }

    .tab-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 14px;
    }

    .tab-btn {
      border: 1px solid #4f78b7;
      border-radius: 10px;
      padding: 10px 12px;
      background: rgba(16, 48, 95, 0.6);
      color: #d8e6ff;
      font-size: 13px;
      font-weight: 700;
    }

    .tab-btn.active {
      background: rgba(36, 86, 158, 0.95);
      color: #fff;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <main class="page">
    <div class="top-nav">
      <button id="topBackBtn" type="button" class="top-back-btn">‚Üê Back</button>
    </div>

    <header class="hero">
      <img class="logo" src="logo.png" alt="MM HELPER Logo" />
      <h1>Risk Calculator</h1>
      <p>Kiraan awal untuk XAUUSD sahaja.</p>
    </header>

    <form id="riskForm" class="card">
      <div class="field">
        <label class="question" for="accountBalance"><strong>1. Modal semasa</strong></label>
        <div class="with-prefix with-suffix">
          <span class="affix">USD</span>
          <input id="accountBalance" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Contoh: 500" required />
        </div>
      </div>

      <div class="field">
        <label class="question" for="riskPercent"><strong>2. Risk per setup (%)</strong></label>
        <div class="with-suffix">
          <input id="riskPercent" type="number" inputmode="decimal" min="0.1" step="0.1" placeholder="Contoh: 1" required />
          <span class="affix">%</span>
        </div>
      </div>

      <div class="field">
        <label class="question" for="zonePips"><strong>3. Saiz zon + SL (pips)</strong></label>
        <p class="hint"><em>Contoh 10 pips pada XAUUSD (andaian 1 pip = 0.10).</em></p>
        <div class="with-suffix">
          <input id="zonePips" type="number" inputmode="decimal" min="1" step="1" placeholder="Contoh: 10" required />
          <span class="affix">pips</span>
        </div>
      </div>

      <div class="field">
        <label class="question" for="layerCount"><strong>4. Bilangan layer</strong></label>
        <select id="layerCount" required>
          <option value="1" selected>1 layer</option>
          <option value="2">2 layer</option>
          <option value="3">3 layer</option>
          <option value="4">4 layer</option>
          <option value="5">5 layer</option>
          <option value="6">6 layer</option>
          <option value="7">7 layer</option>
          <option value="8">8 layer</option>
          <option value="9">9 layer</option>
          <option value="10">10 layer</option>
        </select>
      </div>

      <div class="field">
        <label class="question" for="entryPrice"><strong>5. Entry price XAUUSD</strong></label>
        <div class="with-prefix with-suffix">
          <span class="affix">USD</span>
          <input id="entryPrice" type="number" inputmode="decimal" min="0.1" step="0.1" placeholder="Contoh: 2900" required />
        </div>
      </div>

      <div class="field">
        <label class="question" for="leverage"><strong>6. Leverage account</strong></label>
        <div class="with-prefix">
          <span class="affix">1:</span>
          <input id="leverage" type="number" inputmode="numeric" min="1" step="1" placeholder="Contoh: 500" required />
        </div>
      </div>

      <div class="field">
        <label class="question" for="stopOutPct"><strong>7. Stop-out level (%)</strong></label>
        <p class="hint"><em>Kebanyakan user memang sekitar 30%, tapi tetap check broker sendiri untuk pengesahan.</em></p>
        <div class="with-suffix">
          <select id="stopOutPct" required>
            <option value="0">0%</option>
            <option value="10">10%</option>
            <option value="20">20%</option>
            <option value="30" selected>30%</option>
            <option value="40">40%</option>
            <option value="50">50%</option>
          </select>
        </div>
      </div>

      <button type="submit">üßÆ Kira Lot</button>
      <p id="status" class="status" aria-live="polite"></p>
    </form>

    <div class="tab-row">
      <button id="tabInputBtn" type="button" class="tab-btn active">Result : Custom</button>
      <button id="tabBalanceBtn" type="button" class="tab-btn">Result : Akaun Kau</button>
    </div>

    <section id="resultInputCard" class="result-card">
      <p class="result-title"><strong>Output per setup (XAUUSD)</strong></p>
      <p class="result-line">Risk USD per setup: <strong class="risk-value">USD <span id="riskUsd">0.00</span></strong></p>
      <p class="result-line">Cadangan lot size: <strong><span id="lotSize" class="lot-value">0.00</span> lot</strong></p>
      <p class="result-line">Lot per layer (<span id="selectedLayerLabel">1</span> layer): <strong><span id="lotPerSelectedLayer">0.00</span> lot/layer</strong></p>
      <p class="result-line">Rujukan 2 layer: <strong><span id="lotPerTwoLayer">0.00</span> lot/layer</strong></p>
      <p class="result-line">Rujukan 3 layer: <strong><span id="lotPerThreeLayer">0.00</span> lot/layer</strong></p>
      <p class="result-line">Zon setara harga: <strong>USD <span id="zoneUsd">0.00</span></strong></p>
      <p class="result-line">Used margin anggaran: <strong>USD <span id="usedMargin">0.00</span></strong></p>
      <p class="result-line">Loss max sebelum stop-out: <strong class="risk-value">USD <span id="maxLossBeforeStopOut">0.00</span></strong></p>
      <p class="result-line">Jarak harga max sebelum stop-out: <strong class="risk-value">USD <span id="maxMoveBeforeStopOut">0.00</span></strong></p>
      <p class="result-line">Anggaran floating @ zon penuh: <strong class="risk-value">USD <span id="floatingFull">0.00</span></strong></p>
      <p class="result-line">Anggaran floating @ separuh zon: <strong class="risk-value">USD <span id="floatingHalf">0.00</span></strong></p>
      <p class="hint"><em>Andaian kiraan: contract size XAUUSD = 100, 1 pip = 0.10, maka 1.00 lot ‚âà USD 10 per pip.</em></p>
    </section>

    <section id="resultBalanceCard" class="result-card hidden">
      <p class="result-title"><strong>Output ikut Current Balance Sebenar</strong></p>
      <p class="hint"><em>Dikira dari current balance sahaja, tidak termasuk baki tabung.</em></p>
      <p class="result-line">Current Balance: <strong>USD <span id="liveBalance">0.00</span></strong></p>
      <p class="result-line">Risk USD per setup: <strong class="risk-value">USD <span id="riskUsdLive">0.00</span></strong></p>
      <p class="result-line">Cadangan lot size: <strong><span id="lotSizeLive" class="lot-value">0.00</span> lot</strong></p>
      <p class="result-line">Lot per layer (<span id="selectedLayerLabelLive">1</span> layer): <strong><span id="lotPerSelectedLayerLive">0.00</span> lot/layer</strong></p>
      <p class="result-line">Rujukan 2 layer: <strong><span id="lotPerTwoLayerLive">0.00</span> lot/layer</strong></p>
      <p class="result-line">Rujukan 3 layer: <strong><span id="lotPerThreeLayerLive">0.00</span> lot/layer</strong></p>
      <p class="result-line">Zon setara harga: <strong>USD <span id="zoneUsdLive">0.00</span></strong></p>
      <p class="result-line">Used margin anggaran: <strong>USD <span id="usedMarginLive">0.00</span></strong></p>
      <p class="result-line">Loss max sebelum stop-out: <strong class="risk-value">USD <span id="maxLossBeforeStopOutLive">0.00</span></strong></p>
      <p class="result-line">Jarak harga max sebelum stop-out: <strong class="risk-value">USD <span id="maxMoveBeforeStopOutLive">0.00</span></strong></p>
      <p class="result-line">Anggaran floating @ zon penuh: <strong class="risk-value">USD <span id="floatingFullLive">0.00</span></strong></p>
      <p class="result-line">Anggaran floating @ separuh zon: <strong class="risk-value">USD <span id="floatingHalfLive">0.00</span></strong></p>
      <p class="result-line">Daily target rujukan: <strong>USD <span id="dailyTargetUsdLive">0.00</span></strong></p>
      <p class="result-line">Risiko disaran sehari: <strong class="risk-value"><span id="dailyRiskPctLive">0.00</span>%</strong> (<strong class="risk-value">USD <span id="dailyRiskUsdLive">0.00</span></strong>)</p>
      <p class="result-line">Risiko disaran per setup (2 setup): <strong class="risk-value"><span id="perSetupRiskPctLive">0.00</span>%</strong> (<strong class="risk-value">USD <span id="perSetupRiskUsdLive">0.00</span></strong>)</p>
      <p id="liveRecommendationNote" class="hint"><em>Recommendation akan keluar bila data goal tersedia.</em></p>
      <p class="hint"><em>Kiraan guna current balance sebenar user dari sistem.</em></p>
    </section>
  </main>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="risk-calculator.js"></script>
</body>
</html>
